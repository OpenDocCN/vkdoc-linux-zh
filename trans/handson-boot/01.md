# 1.介绍

不是每个人都知道 Fedora。有一天，有人问我一个问题:

*   学生:什么是 Fedora？

*   **我** : Fedora 是 Linux。

*   **学生**:什么是 Linux？

*   **Me** : Linux 是一个操作系统。

*   学生:什么是操作系统？

*   我:它运行电脑。

*   学生:什么是电脑？

*   我:电脑帮助用户。

*   **学生**:什么是用户？

*   **我**:一个用户跟我一样。

*   学生:你到底是谁？

*   我:嗯，我的名字是约格什·巴巴尔。我在 Red Hat 工作了十年，我喜欢谈论操作系统是如何启动的。

## 为什么呢？

众所周知，操作系统启动大约需要 20 到 30 秒。那么，我为什么要写一本 486 页的关于 30 秒启动序列的书呢？答案很简单。

*   没有合适的文档/文章/书籍解释完整的引导顺序。你会发现数百本关于操作系统的好书，但没有一本是关于系统如何启动的。

*   只有知道系统如何引导，才能解决引导问题。

*   如果你是一名系统管理员，参加一个面试，面试官会问 Linux 是如何启动的。

*   “无法启动”问题总是最严重的，因为整个生产系统都会因此而停机。如果系统运行缓慢，生产仍在继续运行；虽然受到影响，但至少它还在运行。一台拥有 10，000 名用户但无法启动的服务器意味着整个生产系统都瘫痪了。这就是引导的重要性，正如我所说，如果你不知道系统如何引导，你就无法解决引导问题。

*   理解启动过程很有趣。

*   在学习这一切的同时，你会获得巨大的快乐。

## 什么事？

那么，到底什么是引导呢？用专业术语来说，把内核从硬盘复制到内存，然后执行的过程叫做*引导*。但是这个定义并没有真正启发我们去学习引导。

我用我自己的话来说:母亲是一个超集，她的新生儿是她的子集。同样，操作系统是一个超集，而引导是它的一个子集。子集属于它的超集。

现在考虑这个说法:“一个孩子生了一个妈妈。”

从技术上来说这是错误的，但是想象一下，直到一个女人有了孩子，她还是一个女人；当一个女人有了孩子，她就成了母亲。所以，孩子生了妈妈。

同样的情况也发生在电脑上。技术上来说引导是操作系统的一部分，操作系统应该催生引导，但是反过来了。是引导催生了操作系统。因此，我们可以说*引导*是产生操作系统的过程。

## 这本书的重点

本书解释了基于 x86 体系结构的台式机或服务器系统的引导过程，并涵盖了各种操作系统的引导过程。主要重点是对 Linux 引导过程的深入分析，次要重点是其他流行的操作系统，如 Windows 和 UNIX。如你所知，有大量的 Linux 发行版。有些是为桌面用户设计的，有些是为企业用户设计的，有些只是为了游戏目的，有些是为喜欢自己动手的用户设计的。几乎不可能涵盖每个发行版的引导顺序。因此，我决定选择 Linux 发行版，这是企业用户的第一选择，那就是 Red Hat Enterprise Linux (RHEL)。

RHEL 是基于 Fedora Linux 的。Fedora 的发行速度很快(六个月的发行周期)，而 RHEL 的发行速度很慢(两到三年的发行周期)。这意味着只要 QE(质量工程)团队一开绿灯，Fedora 就会采用最新的开发成果。因为 Fedora 是流行的企业 Linux 发行版的测试平台，所以 Fedora 中可用的任何东西最终都会成为 RHEL 的一部分。systemd 就是最好的例子。这就是为什么我选择 Fedora Linux 来解释 Linux 引导序列。

## 电源

当你按下电源按钮时，一切都开始了。按下电源按钮，电源就到了主板上。主板向你的电源(SMPS/PSU)发送信号，它返回一个良好的电源，结果主板试图启动 CPU。

## 中央处理器

当基于 x86 架构的 CPU 启动时，它会清除所有寄存器中的旧数据，并从以下内容开始:

```sh
IP              0xfff0
CS selector     0xf000
CS base         0xffff0000

```

`0xffff0000` + `0xfff0` = `0xfffffff0`。这是 CPU 期望找到要执行的第一条指令的内存位置。在这个位置，它包含一个指向 BIOS 入口点的跳转指令。换句话说，这就是 BIOS 启动或 CPU 进入 BIOS/固件的方式。

在这之后，固件和引导装载程序是引导过程的下一个阶段。启动操作系统的引导程序是固件的工作。在下一章，我将讨论固件中发生了什么，以及它是如何执行引导程序的。