# 二、做好准备

这本书定义了一种哲学，但它也旨在用你可以进行的实验来阐明这种哲学的实际方面。因为我们系统管理员是一群亲自动手的人，所以这本书提供了一些简单的实验，你可以通过这些实验来更全面地欣赏和理解哲学的原则。大多数实验通常由一行 bash shell 命令或程序组成。有些实验确实使用了不止一条线。

这一章将会告诉你更多关于实验的期待。它将描述适用于这些实验的 Linux 计算机的最佳配置，并且它将为您提供一个准备在一些实验中使用的 USB 拇指驱动器的机会。

## 实验

作为一名动手的系统管理员，我喜欢尝试命令行，以便学习新的命令和执行任务的新方法。我为这本书设计的大部分实验都是我在自己的探索中完成的，可能做了一些小的改动以适应它们在这里的使用。

请注意，有些原则不适合实验；因此，不是你在本书中读到的每一个原则都会用实验来说明，但是尽可能多的人会做实验。许多实验说明了更多的原理，而不仅仅是它们出现的原理。

所有的系统管理员都是亲力亲为的人，尽管我们有不同的学习方式。我认为对系统管理员来说，拥有这些原则的实践经验是很有帮助的，这样才能充分想象和欣赏它们所体现的真理。这就是实验的目的——提供一个超越理论并以实际方式应用原则的机会。尽管有些实验是为了说明某一点而做的，但它们仍然是有效的。

这些启发性的实验并没有藏在每一章或每本书的结尾，在那里它们很容易被忽略——它们嵌入在文本中，是这本书流程中不可或缺的一部分。我建议你在阅读这本书时进行实验。

每个实验的命令和结果会出现在“实验”部分，如下所示。许多实验只需要一个命令，因此只有一个“实验”部分。其他的实验可能更复杂，因此分成两个或更多的实验部分。

### 实验示例

这是一个实验的例子。每个实验都有说明和代码，让你在电脑上输入。

许多实验会有一系列像这一段这样的散文格式的说明。只要按照说明做，实验就会顺利进行。

1.  有些实验会有一系列要执行的步骤。

2.  第二步。

3.  等等…

```sh
Code that you are to enter for the experiments will look like this.

```

实验到此结束。

这些实验中的大部分都可以作为非 root 用户来执行；这比以 root 用户身份做任何事情都要安全得多。但是，对于其中一些实验，您需要成为 root 用户。

这些实验被认为在指定用于培训的计算机或虚拟机上使用是安全的。不管它们看起来有多好，您都不应该在生产系统上执行这些实验。

### 警告！

这些实验不应该使用生产计算机。您应该使用专门用于培训的计算机或虚拟机。

有时候，我想展示一些有趣的代码，但是你不应该在实验中运行这些代码。对于这种情况，我会将代码和任何支持文本放在如下所示的**代码示例**部分中。

### 代码示例

旨在说明某一点但你甚至不应该考虑在任何计算机上运行的代码将包含在这样的一个部分中。

```sh
echo "This is sample code which you should never run."

```

## 系统需求

你需要一台安装了 Linux 的计算机来进行这些实验。这台计算机的规格相对不重要，因为即使最小的 Linux 计算机也提供终端模拟器或控制台会话来访问命令行。为了获得最佳效果，您可以考虑的最低配置是英特尔或 AMD 硬件，至少 2GB 内存和 i3 处理器或同等配置。必要时，安装了最新版 Raspbian 的树莓派 3B 也能派上用场。

你在本书中用于实验的计算机应该是最新的主流版本，比如 Fedora、Ubuntu、Mint、RHEL 或 CentOS。无论您使用哪个发行版，都应该安装了 GUI 桌面并可供使用。一些实验需要在桌面上打开多个终端仿真会话。

你还需要一个 USB 拇指驱动器，在上面进行一些更危险的实验，包括读写硬盘上的数据。USB 拇指驱动器是一个合适的替代品，其工作方式与真正的硬盘驱动器完全相同，硬盘驱动器有旋转的磁盘和移动的磁头等。

我强烈建议您使用一台没有用于任何其他用途的主机，例如一个专门用于培训的系统，或者一台运行在 VirtualBox 等免费开源软件上的虚拟机来安装 Linux 并执行这些实验。这将大大降低生产计算机受损的可能性。

您应该对用于这些实验的计算机或虚拟机拥有 root 访问权限。如果您在任何计算机上都没有 root 用户，您将无法执行其中的一些实验。需要 root 访问权限的实验会通知您。

您应该使用一个帐户，如“学生”帐户来尝试这些实验中的大部分。这进一步降低了损坏您自己的文件的危险。事实上，大多数实验都假设您以非特权用户 student 的身份登录。

### 警告！

不要在生产系统上进行本书中介绍的实验。

### 如何访问命令行

所有现代主流 Linux 发行版都至少提供了三种访问命令行的方式。

如果您使用图形桌面，大多数发行版都有多个终端模拟器可供选择。我更喜欢 Krusader 和 Tilix，但是你可以使用任何你喜欢的终端模拟器。

Linux 还为多个虚拟控制台提供了功能，允许从一个键盘和显示器进行多次登录。虚拟控制台可以在没有 GUI 桌面的系统上使用，但也可以在有 GUI 桌面的系统上使用。

每个虚拟控制台被分配给对应于控制台编号的功能键。因此 vc1 将被分配给功能键 F1，依此类推。在这些会话之间切换很容易。在您的计算机上，您可以按住 Ctrl 和 Alt 键并按 F2 切换到 vc2。然后按住 Ctrl 和 Alt 键，按 F1 切换到 vc1 和图形界面。

在 Linux 计算机上访问命令行的最后一种方法是通过远程登录。安全 Shell(SSH)是最常见的远程访问方法。

如果您可以本地访问的计算机不适合运行这些实验，但是您可以访问远程计算机，也就是说，您可以 SSH 到该计算机来运行实验。对于某些实验，您需要多次登录。

我们将在第 [7](07.html) 章中详细介绍终端模拟器和控制台会话。

### 创建学生用户

作为 root 用户，您应该立即在您将用于这些实验的计算机上创建一个新用户，用户 ID 为“student”，不带引号。将密码设置为您能记住的任何合理安全的值。

### 制备 2-1

输入以下命令创建学生用户并分配密码。

```sh
[root@testvm1 ~]# useradd -c "Student User" student
[root@testvm1 ~]# passwd student
Changing password for user student.
New password: <Enter password>
Retype new password: <Enter password again>
passwd: all authentication tokens updated successfully.

```

### 准备 USB 拇指驱动器

你可以用一个没有其他用途的 u 盘安全地进行许多实验。当然，您将不得不在其上重新创建分区和文件系统，以便在我们完成时它可以再次使用。

我发现了一个旧的 USB 2.0 64MB 是的 MB-拇指驱动器，我目前没有其他用途，所以我设置它用于这些实验。你可以使用手头上任何大小的 u 盘，但是小的也可以。

### 准备 2-2

准备用于这些实验的 USB 设备。

1.  在您将用于本实验的计算机上打开一个终端会话，并以 root 用户身份登录。

2.  将 USB 设备插入 Linux 计算机上的 USB 插槽。

3.  使用 dmesg 命令确定内核将哪个设备文件分配给了 USB 驱动器。可能会是/dev/sdb 之类的。dmesg 输出应该显示至少一个分区/dev/sdb1。在您的 Linux 计算机上，驱动器盘符(在本例中为 b)可能是不同的盘符。

    **警告**如果在命令中指定了错误的设备，以下步骤可能会导致生产系统上的数据完全销毁。确保使用非生产系统进行此实验。

4.  在/mnt 上挂载驱动器的分区。

5.  将 PWD 更改为/mnt。

6.  删除任何先前存在的文件。

7.  输入并运行以下命令，在驱动器上创建一些包含内容的文件。

    ```sh
    for I in 0 1 2 3 4 5 6 7 8 9 ; do dmesg > file$I.txt;done

    ```

8.  验证驱动器上现在至少有 10 个名为 file0.txt 到 file9.txt 的文件。

9.  将 PWD 更改为 root 的主目录。

10.  卸载 USB 驱动器，并将其从计算机中移除，直到需要它为止。

USB 驱动器现在可以在我们的实验中使用了。

## 如果实验不成功该怎么办

这些实验是独立的，不依赖于任何设置，除了 USB 拇指驱动器或之前进行的实验的结果。某些 Linux 实用程序和工具必须存在，但这些都应该在标准 Fedora Linux 工作站安装或任何其他主流通用发行版中可用。

因此，所有这些实验都应该“正常工作”我们都知道那是怎么回事，对吧？因此，当某件事情失败时，首先要做的事情是显而易见的。

1.  验证命令输入是否正确。这是我自己遇到的最常见的问题。

2.  您可能会看到一条错误消息，指示找不到该命令。bash shell 显示了错误的命令；在这种情况下，我编造了 badcommand。然后给出了问题的简要描述。对于缺失和拼写错误的命令，都会显示此错误消息。多次检查命令的拼写和语法，以验证它是否正确。

    ```sh
    [student@testvm1 ~]$ badcommand
    bash: badcommand: command not found...

    ```

3.  使用 man 命令查看手册页(手册页),以验证命令的语法和拼写是否正确。

4.  确保实际上安装了所需的命令。如果尚未安装，请安装它们。

5.  对于要求您以 root 身份登录的实验，请确保您已经这样做了。应该只有几个，但是作为非根用户执行它们是不行的。

应该不会有太多其他问题——但是如果你遇到一个你无法用这些技巧解决的问题，请通过`LinuxGeek46@both.org`联系我，我会尽力帮助你解决问题。